---
title: "demo2-vis"
author: "Haiyi Shi (hshi786)"
date: "12/10/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(INLA)
library(ggplot2)
library(plyr)
library(tidyverse)
library(dplyr)
library(tidyverse)
library(hrbrthemes)
library(viridis)
library(knitr)
library(patchwork)
```


```{}
fix_results <- do.call('rbind', lapply(list.files(pattern = "demo-sum-fixed"), read.csv))
write.csv(fix_results, "All-fixed.csv", row.names = FALSE)

marg_fixed <- do.call('rbind', lapply(list.files(pattern = "demo-marg-fixed"), read.csv))
write.csv(marg_fixed, "All-marg-fixed.csv", row.names = FALSE)

kappa_results <- do.call('rbind', lapply(list.files(pattern = "demo-marg-kappa"), read.csv))
write.csv(kappa_results, "All-marg-kappa.csv", row.names = FALSE)

range_results <- do.call('rbind', lapply(list.files(pattern = "demo-marg-range"), read.csv))
write.csv(range_results, "All-marg-range.csv", row.names = FALSE)

var_results <- do.call('rbind', lapply(list.files(pattern = "demo-marg-var"), read.csv))
write.csv(var_results, "All-marg-var.csv", row.names = FALSE)

dic_results <- do.call('rbind', lapply(list.files(pattern = "demo-dic"), read.csv))
write.csv(dic_results, "All-DIC.csv", row.names = FALSE)

waic_results <- do.call('rbind', lapply(list.files(pattern = "demo-waic"), read.csv))
write.csv(waic_results, "All-WAIC.csv", row.names = FALSE)

time_results <- do.call('rbind', lapply(list.files(pattern = "demo-time"), read.csv))
write.csv(time_results, "All-times.csv", row.names = FALSE)
```


## Read Data

```{r}
levels <- paste0("Mesh", 1:36)
fixed <- read.csv("All-fixed.csv")
fixed$meshes <- factor(fixed$Mesh, levels = levels)

margfixed <- read.csv("All-marg-fixed.csv")
margfixed$meshes <- factor(margfixed$Mesh, levels = levels)

margkappa <- read.csv("All-marg-kappa.csv")
margkappa$meshes <- factor(margkappa$Mesh, levels = levels)

margrange <- read.csv("All-marg-range.csv")
margrange$meshes <- factor(margrange$Mesh, levels = levels)

margvar <- read.csv("All-marg-var.csv")
margvar$meshes <- factor(margvar$Mesh, levels = levels)

dic <- read.csv("All-DIC.csv")
dic$meshes <- factor(dic$Mesh, levels = levels)
subset(dic, is.na(dic$DIC))

waic <- read.csv("All-WAIC.csv")
waic$meshes <- factor(waic$Mesh, levels = levels)
subset(waic, is.na(waic$WAIC))

times <- read.csv("All-times.csv")
times$meshes <- factor(times$Mesh, levels = levels)
```




## Summary fixed
### MSE

```{r}
fixed$diff <- fixed$True - fixed$mean
MSE <- fixed %>%
  group_by(meshes) %>%
  summarize(across("diff", ~ sum(.x^2)/n()))
kable(MSE, align = "cc", digits = 4)
```


### MSE  by Set

```{r}
fixed.set <- split(fixed, fixed$Set)
MSE1 <- fixed.set[[1]] %>%
  group_by(meshes) %>%
  summarize(across("diff", ~ sum(.x^2)/n()))
kable(MSE1, align = "cc", digits = 6)
MSE1 <- MSE1[-3, ]

MSE2 <- fixed.set[[2]] %>%
  group_by(meshes) %>%
  summarize(across("diff", ~ sum(.x^2)/n()))
kable(MSE2, align = "cc", digits = 6)
MSE2 <- MSE2[-3, ]

MSE3 <- fixed.set[[3]] %>%
  group_by(meshes) %>%
  summarize(across("diff", ~ sum(.x^2)/n()))
kable(MSE3, align = "cc", digits = 6)

MSE4 <- fixed.set[[4]] %>%
  group_by(meshes) %>%
  summarize(across("diff", ~ sum(.x^2)/n()))
kable(MSE4, align = "cc", digits = 6)
```


### The mean square error between the estimated and true mean.

```{r, fig.width=10, fig.height=6}
for (i in 1:4){
  mse <- ggplot(get(paste0("MSE", i)), aes(x=meshes, y=diff)) +
    geom_point() +
    scale_color_brewer(palette = "Dark2") +
    theme_linedraw() +
    theme(axis.title.x=element_blank(),
          axis.text.x=element_text(angle = 35, hjust = 1)) +
    labs(x="Mesh",y="MSE", title="The mean square error between the estimated and true mean.")
  print(mse)
}
```


### Summary fixed: fixed by meshes

```{r, fig.width=10, fig.height=6}
ggplot(fixed, aes(meshes, mean, group = meshes, color = Set)) +
  geom_point(position = position_jitterdodge(jitter.width = .2, dodge.width = .7), 
             alpha = .5) +
  stat_summary(fun = mean, na.rm = TRUE, 
               geom = "point", shape = "diamond",
               size = 2, color = "black", 
               position = position_dodge(width = .7)) +
  stat_summary(fun.data = mean_cl_normal, na.rm = TRUE, 
               geom = "errorbar", width = .2, color = "black",
               position = position_dodge(width = .7)) +
  scale_color_brewer(palette = "Dark2") +
  theme_linedraw() +
  theme(axis.title.x=element_blank(),
        axis.text.x=element_text(angle = 35, hjust = 1))
```


### fixed by Set

```{r, fig.width=10, fig.height=6}
ggplot(fixed, aes(meshes, mean, group = Set, color = Set)) +
  geom_point(position = position_jitterdodge(jitter.width = .2, dodge.width = .7), 
             alpha = .5) +
  stat_summary(fun = mean, na.rm = TRUE, 
               geom = "point", shape = "diamond",
               size = 2, color = "black", 
               position = position_dodge(width = .7)) +
  stat_summary(fun.data = mean_cl_normal, na.rm = TRUE, 
               geom = "errorbar", width = .2, color = "black",
               position = position_dodge(width = .7)) +
  scale_color_brewer(palette = "Dark2") +
  theme_linedraw() +
  theme(axis.title.x=element_blank(),
        axis.text.x=element_text(angle = 35, hjust = 1))
```




## The marginal fixed

The posterior distribution of the log-Cox model parameters.

```{r, fig.width=10, fig.height=6}
margfixed.set <- split(margfixed, margfixed$Set)
truefixed <- c(4,4,2,2)
### Set 1
ggplot(margfixed.set[[1]], aes(x=x, y=y, group=Pattern, color=Pattern)) + 
  geom_line() + 
  facet_wrap(~ meshes, scales = "free") +
  geom_vline(xintercept = truefixed[1], col = 1, linetype = "dashed") +
  labs(x=expression(beta[0]), y="Density", title = paste("Set", 1, sep=" ")) +
  scale_color_brewer(palette = "Set1") +
  theme_light() +
  theme(plot.title = element_text(size=11),
        axis.text.x = element_text(hjust = 1, size = unit(7, "lines")),
        axis.text.y = element_text(hjust = 1, size = unit(7, "lines")),
        panel.spacing = unit(0.5, "lines"), 
        strip.text = element_text(size=8, face="bold"))

### Set 2
ggplot(margfixed.set[[2]], aes(x=x, y=y, group=Pattern, color=Pattern)) + 
  geom_line() + 
  facet_wrap(~ meshes, scales = "free") +
  geom_vline(xintercept = truefixed[2], col = 1, linetype = "dashed") +
  labs(x=expression(beta[0]), y="Density", title = paste("Set", 2, sep=" ")) +
  scale_color_brewer(palette = "Set1") +
  theme_light() +
  theme(plot.title = element_text(size=11),
        axis.text.x = element_text(hjust = 1, size = unit(7, "lines")),
        axis.text.y = element_text(hjust = 1, size = unit(7, "lines")),
        panel.spacing = unit(0.5, "lines"), 
        strip.text = element_text(size=8, face="bold"))

### Set 3
ggplot(margfixed.set[[3]], aes(x=x, y=y, group=Pattern, color=Pattern)) + 
  geom_line() + 
  facet_wrap(~ meshes, scales = "free") +
  geom_vline(xintercept = truefixed[3], col = 1, linetype = "dashed") +
  labs(x=expression(beta[0]), y="Density", title = paste("Set", 3, sep=" ")) +
  scale_color_brewer(palette = "Set1") +
  theme_light() +
  theme(plot.title = element_text(size=11),
        axis.text.x = element_text(hjust = 1, size = unit(7, "lines")),
        axis.text.y = element_text(hjust = 1, size = unit(7, "lines")),
        panel.spacing = unit(0.5, "lines"), 
        strip.text = element_text(size=8, face="bold"))

### Set 4
ggplot(margfixed.set[[4]], aes(x=x, y=y, group=Pattern, color=Pattern)) + 
  geom_line() + 
  facet_wrap(~ meshes, scales = "free") +
  geom_vline(xintercept = truefixed[4], col = 1, linetype = "dashed") +
  labs(x=expression(beta[0]), y="Density", title = paste("Set", 4, sep=" ")) +
  scale_color_brewer(palette = "Set1") +
  theme_light() +
  theme(plot.title = element_text(size=11),
        axis.text.x = element_text(hjust = 1, size = unit(7, "lines")),
        axis.text.y = element_text(hjust = 1, size = unit(7, "lines")),
        panel.spacing = unit(0.5, "lines"), 
        strip.text = element_text(size=8, face="bold"))
```



## `marginals.kappa`

```{r, fig.width=10, fig.height=6}
margkappa.set <- split(margkappa, margkappa$Set)
truekappa <- c(10,2,10,2)

### Set 1
ggplot(margkappa.set[[1]], aes(x=x, y=y, group=Pattern, color=Pattern)) + 
  geom_line() + 
  facet_wrap(~ meshes, scales = "free") +
  geom_vline(xintercept = truekappa[1], col = 1, linetype = "dashed") +
  labs(x=expression(kappa), y="Density", title = paste("Set", 1, sep=" ")) +
  scale_color_brewer(palette = "Set1") +
  theme_light() +
  theme(plot.title = element_text(size=11),
        axis.text.x = element_text(hjust = 1, size = unit(7, "lines")),
        axis.text.y = element_text(hjust = 1, size = unit(7, "lines")),
        panel.spacing = unit(0.5, "lines"), 
        strip.text = element_text(size=8, face="bold"))

### Set 2
ggplot(margkappa.set[[2]], aes(x=x, y=y, group=Pattern, color=Pattern)) + 
  geom_line() + 
  facet_wrap(~ meshes, scales = "free") +
  geom_vline(xintercept = truekappa[2], col = 1, linetype = "dashed") +
  labs(x=expression(kappa), y="Density", title = paste("Set", 2, sep=" ")) +
  scale_color_brewer(palette = "Set1") +
  theme_light() +
  theme(plot.title = element_text(size=11),
        axis.text.x = element_text(hjust = 1, size = unit(7, "lines")),
        axis.text.y = element_text(hjust = 1, size = unit(7, "lines")),
        panel.spacing = unit(0.5, "lines"), 
        strip.text = element_text(size=8, face="bold"))

### Set 3
ggplot(margkappa.set[[3]], aes(x=x, y=y, group=Pattern, color=Pattern)) + 
  geom_line() + 
  facet_wrap(~ meshes, scales = "free") +
  geom_vline(xintercept = truekappa[3], col = 1, linetype = "dashed") +
  labs(x=expression(kappa), y="Density", title = paste("Set", 3, sep=" ")) +
  scale_color_brewer(palette = "Set1") +
  theme_light() +
  theme(plot.title = element_text(size=11),
        axis.text.x = element_text(hjust = 1, size = unit(7, "lines")),
        axis.text.y = element_text(hjust = 1, size = unit(7, "lines")),
        panel.spacing = unit(0.5, "lines"), 
        strip.text = element_text(size=8, face="bold"))

### Set 4
ggplot(margkappa.set[[4]], aes(x=x, y=y, group=Pattern, color=Pattern)) + 
  geom_line() + 
  facet_wrap(~ meshes, scales = "free") +
  geom_vline(xintercept = truekappa[4], col = 1, linetype = "dashed") +
  labs(x=expression(kappa), y="Density", title = paste("Set", 4, sep=" ")) +
  scale_color_brewer(palette = "Set1") +
  theme_light() +
  theme(plot.title = element_text(size=11),
        axis.text.x = element_text(hjust = 1, size = unit(7, "lines")),
        axis.text.y = element_text(hjust = 1, size = unit(7, "lines")),
        panel.spacing = unit(0.5, "lines"), 
        strip.text = element_text(size=8, face="bold"))
```



## `marginals.variance.nominal`

```{r, fig.width=10, fig.height=6}
margvar.set <- split(margvar, margvar$Set)
true <- c(1,1,1,1)
### Set 1
ggplot(margvar.set[[1]], aes(x=x, y=y, group=Pattern, color=Pattern)) + 
  geom_line() + 
  facet_wrap(~ meshes, scales = "free") +
  geom_vline(xintercept = true[1], col = 1, linetype = "dashed") +
  labs(x=expression(sigma^2), y="Density", title = paste("Set", 1, sep=" ")) +
  scale_color_brewer(palette = "Set1") +
  theme_light() +
  theme(plot.title = element_text(size=11),
        axis.text.x = element_text(hjust = 1, size = unit(7, "lines")),
        axis.text.y = element_text(hjust = 1, size = unit(7, "lines")),
        panel.spacing = unit(0.5, "lines"), 
        strip.text = element_text(size=8, face="bold"))

### Set 2
ggplot(margvar.set[[2]], aes(x=x, y=y, group=Pattern, color=Pattern)) + 
  geom_line() + 
  facet_wrap(~ meshes, scales = "free") +
  geom_vline(xintercept = true[2], col = 1, linetype = "dashed") +
  labs(x=expression(sigma^2), y="Density", title = paste("Set", 2, sep=" ")) +
  scale_color_brewer(palette = "Set1") +
  theme_light() +
  theme(plot.title = element_text(size=11),
        axis.text.x = element_text(hjust = 1, size = unit(7, "lines")),
        axis.text.y = element_text(hjust = 1, size = unit(7, "lines")),
        panel.spacing = unit(0.5, "lines"), 
        strip.text = element_text(size=8, face="bold"))

### Set 3
ggplot(margvar.set[[3]], aes(x=x, y=y, group=Pattern, color=Pattern)) + 
  geom_line() + 
  facet_wrap(~ meshes, scales = "free") +
  geom_vline(xintercept = true[3], col = 1, linetype = "dashed") +
  labs(x=expression(sigma^2), y="Density", title = paste("Set", 3, sep=" ")) +
  scale_color_brewer(palette = "Set1") +
  theme_light() +
  theme(plot.title = element_text(size=11),
        axis.text.x = element_text(hjust = 1, size = unit(7, "lines")),
        axis.text.y = element_text(hjust = 1, size = unit(7, "lines")),
        panel.spacing = unit(0.5, "lines"), 
        strip.text = element_text(size=8, face="bold"))

### Set 4
ggplot(margvar.set[[4]], aes(x=x, y=y, group=Pattern, color=Pattern)) + 
  geom_line() + 
  facet_wrap(~ meshes, scales = "free") +
  geom_vline(xintercept = true[4], col = 1, linetype = "dashed") +
  labs(x=expression(sigma^2), y="Density", title = paste("Set", 4, sep=" ")) +
  scale_color_brewer(palette = "Set1") +
  theme_light() +
  theme(plot.title = element_text(size=11),
        axis.text.x = element_text(hjust = 1, size = unit(7, "lines")),
        axis.text.y = element_text(hjust = 1, size = unit(7, "lines")),
        panel.spacing = unit(0.5, "lines"), 
        strip.text = element_text(size=8, face="bold"))
```

## `marginals.range.nominal`

```{r, fig.width=10, fig.height=6}
margrange.set <- split(margrange, margrange$Set)
### Set 1
ggplot(margrange.set[[1]], aes(x=x, y=y, group=Pattern, color=Pattern)) + 
  geom_line() + 
  facet_wrap(~ meshes, scales = "free") +
  geom_vline(xintercept = sqrt(8)/truekappa[1], col = 1, linetype = "dashed") +
  labs(x="Nominal range", y="Density", title = paste("Set", 1, sep=" ")) +
  scale_color_brewer(palette = "Set1") +
  theme_light() +
  theme(plot.title = element_text(size=11),
        axis.text.x = element_text(hjust = 1, size = unit(7, "lines")),
        axis.text.y = element_text(hjust = 1, size = unit(7, "lines")),
        panel.spacing = unit(0.5, "lines"), 
        strip.text = element_text(size=8, face="bold"))

### Set 2
ggplot(margrange.set[[2]], aes(x=x, y=y, group=Pattern, color=Pattern)) + 
  geom_line() + 
  facet_wrap(~ meshes, scales = "free") +
  geom_vline(xintercept = sqrt(8)/truekappa[2], col = 1, linetype = "dashed") +
  labs(x="Nominal range", y="Density", title = paste("Set", 2, sep=" ")) +
  scale_color_brewer(palette = "Set1") +
  theme_light() +
  theme(plot.title = element_text(size=11),
        axis.text.x = element_text(hjust = 1, size = unit(7, "lines")),
        axis.text.y = element_text(hjust = 1, size = unit(7, "lines")),
        panel.spacing = unit(0.5, "lines"), 
        strip.text = element_text(size=8, face="bold"))

### Set 3
ggplot(margrange.set[[3]], aes(x=x, y=y, group=Pattern, color=Pattern)) + 
  geom_line() + 
  facet_wrap(~ meshes, scales = "free") +
  geom_vline(xintercept = sqrt(8)/truekappa[3], col = 1, linetype = "dashed") +
  labs(x="Nominal range", y="Density", title = paste("Set", 3, sep=" ")) +
  scale_color_brewer(palette = "Set1") +
  theme_light() +
  theme(plot.title = element_text(size=11),
        axis.text.x = element_text(hjust = 1, size = unit(7, "lines")),
        axis.text.y = element_text(hjust = 1, size = unit(7, "lines")),
        panel.spacing = unit(0.5, "lines"), 
        strip.text = element_text(size=8, face="bold"))

### Set 4
ggplot(margrange.set[[4]], aes(x=x, y=y, group=Pattern, color=Pattern)) + 
  geom_line() + 
  facet_wrap(~ meshes, scales = "free") +
  geom_vline(xintercept = sqrt(8)/truekappa[4], col = 1, linetype = "dashed") +
  labs(x="Nominal range", y="Density", title = paste("Set", 4, sep=" ")) +
  scale_color_brewer(palette = "Set1") +
  theme_light() +
  theme(plot.title = element_text(size=11),
        axis.text.x = element_text(hjust = 1, size = unit(7, "lines")),
        axis.text.y = element_text(hjust = 1, size = unit(7, "lines")),
        panel.spacing = unit(0.5, "lines"), 
        strip.text = element_text(size=8, face="bold"))
```


## DIC
### DIC by meshes
```{r, fig.width=10, fig.height=6}
dic_set <- split(dic, dic$Set)
dic_set1 <- dic_set[[1]] %>%
  group_by(meshes) %>%
  summarise_at(vars(DIC), list(name = mean))
dic_set1[which.min(dic_set1$name),]
dic_set1[which.max(dic_set1$name),]


dic_set2 <- dic_set[[2]] %>%
  group_by(meshes) %>%
  summarise_at(vars(DIC), list(name = mean))
dic_set2[which.min(dic_set2$name),]
dic_set2[which.max(dic_set2$name),]


dic_set3 <- dic_set[[3]] %>%
  group_by(meshes) %>%
  summarise_at(vars(DIC), list(name = mean))
dic_set3[which.min(dic_set3$name),]
dic_set3[which.max(dic_set3$name),]


dic_set4 <- dic_set[[4]] %>%
  group_by(meshes) %>%
  summarise_at(vars(DIC), list(name = mean))
dic_set4[which.min(dic_set4$name),]
dic_set4[which.max(dic_set4$name),]

ggplot(dic, aes(x=meshes, y=DIC, group = meshes, color = Set)) +
  geom_point(position = position_jitterdodge(jitter.width = .2, dodge.width = .7), 
             alpha = .5) +
  stat_summary(fun = mean, na.rm = TRUE, 
               geom = "point", shape = "diamond",
               size = 2, color = "black", 
               position = position_dodge(width = .7)) +
  stat_summary(fun.data = mean_cl_normal, na.rm = TRUE, 
               geom = "errorbar", width = .2, color = "black",
               position = position_dodge(width = .7)) +
  scale_color_brewer(palette = "Dark2") +
  theme_linedraw() +
  theme(axis.title.x=element_blank(),
        axis.text.x=element_text(angle = 45, hjust = 1))
```

### DIC by Set
```{r, fig.width=10, fig.height=6}
ggplot(dic, aes(x=meshes, y=-DIC, group = Set, color = Set)) +
  geom_point(position = position_jitterdodge(jitter.width = .2, dodge.width = .7), 
             alpha = .5) +
  stat_summary(fun = mean, na.rm = TRUE, 
               geom = "point", shape = "diamond",
               size = 2, color = "black", 
               position = position_dodge(width = .7)) +
  stat_summary(fun.data = mean_cl_normal, na.rm = TRUE, 
               geom = "errorbar", width = .2, color = "black",
               position = position_dodge(width = .7)) +
  scale_color_brewer(palette = "Dark2") +
  theme_linedraw() +
  theme(axis.title.x=element_blank(),
        axis.text.x=element_text(angle = 45, hjust = 1))
```



## WAIC
### WAIC by meshes
```{r, fig.width=10, fig.height=6}
waic_set <- split(waic, waic$Set)
waic_set1 <- waic_set[[1]] %>%
  group_by(meshes) %>%
  summarise_at(vars(WAIC), list(name = mean))
waic_set1[which.min(waic_set1$name),]
waic_set1[which.max(waic_set1$name),]


waic_set2 <- waic_set[[2]] %>%
  group_by(meshes) %>%
  summarise_at(vars(WAIC), list(name = mean))
waic_set2[which.min(waic_set2$name),]
waic_set2[which.max(waic_set2$name),]


waic_set3 <- waic_set[[3]] %>%
  group_by(meshes) %>%
  summarise_at(vars(WAIC), list(name = mean))
waic_set3[which.min(waic_set3$name),]
waic_set3[which.max(waic_set3$name),]


waic_set4 <- waic_set[[4]] %>%
  group_by(meshes) %>%
  summarise_at(vars(WAIC), list(name = mean))
waic_set4[which.min(waic_set4$name),]
waic_set4[which.max(waic_set4$name),]



ggplot(waic, aes(x=meshes, y=-WAIC, group = meshes, color = Set)) +
  geom_point(position = position_jitterdodge(jitter.width = .2, dodge.width = .7), 
             alpha = .5) +
  stat_summary(fun = mean, na.rm = TRUE, 
               geom = "point", shape = "diamond",
               size = 2, color = "black", 
               position = position_dodge(width = .7)) +
  stat_summary(fun.data = mean_cl_normal, na.rm = TRUE, 
               geom = "errorbar", width = .2, color = "black",
               position = position_dodge(width = .7)) +
  scale_color_brewer(palette = "Dark2") +
  theme_linedraw() +
  theme(axis.title.x=element_blank(),
        axis.text.x=element_text(angle = 45, hjust = 1))
```

### WAIC by Set
```{r, fig.width=10, fig.height=6}
ggplot(waic, aes(x=meshes, y=-WAIC, group = Set, color = Set)) +
  geom_point(position = position_jitterdodge(jitter.width = .2, dodge.width = .7), 
             alpha = .5) +
  stat_summary(fun = mean, na.rm = TRUE, 
               geom = "point", shape = "diamond",
               size = 2, color = "black", 
               position = position_dodge(width = .7)) +
  stat_summary(fun.data = mean_cl_normal, na.rm = TRUE, 
               geom = "errorbar", width = .2, color = "black",
               position = position_dodge(width = .7)) +
  scale_color_brewer(palette = "Dark2") +
  theme_linedraw() +
  theme(axis.title.x=element_blank(),
        axis.text.x=element_text(angle = 45, hjust = 1))
```



## Computational time
### By Mesh
```{r, fig.width=10, fig.height=6}
# stat_summary with arg "fun.data": 
# A function that is given the complete data and should return a data frame
# with variables ymin, y, and ymax (for use in plotting ranges).
# mean_cl_normal() is intended for use with stat_summary. It calculates
# sample mean and lower and upper Gaussian confidence limits based on the t-distribution
ggplot(times, aes(x=meshes, y=elapsed, group=meshes, color=Set)) +
  geom_point(position = position_jitterdodge(jitter.width = .2, dodge.width = .7), 
             alpha = .5) +
  stat_summary(fun = mean, na.rm = TRUE, 
               geom = "point", color = "black", 
               size = 2, shape = "diamond") +
  stat_summary(fun.data = mean_cl_normal, na.rm =TRUE, 
               geom = "errorbar", width = .2, color = "black") +
  theme(axis.text.x=element_text(angle = 90, size = 7)) +
  scale_color_brewer(palette = "Dark2") +
  theme_linedraw() +
  theme(axis.title.x=element_blank(),
        axis.text.x=element_text(angle = 35, hjust = 1))
```

### By Set
```{r, fig.width=10, fig.height=6}
ggplot(times, aes(x=meshes, y=elapsed, group=Set, color=Set)) +
  geom_point(position = position_jitterdodge(jitter.width = .2, dodge.width = .7), 
             alpha = .5) +
  stat_summary(fun = mean, na.rm = TRUE, 
               position = position_dodge(width = .7),
               geom = "point", color = "black", 
               size = 2, shape = "diamond") +
  stat_summary(fun.data = mean_cl_normal, na.rm =TRUE, 
               position = position_dodge(width = .7),
               geom = "errorbar", width = .2, color = "black") +
  theme(axis.text.x=element_text(angle = 90, size = 7)) +
  scale_color_brewer(palette = "Dark2") +
  theme_linedraw() +
  theme(axis.title.x=element_blank(),
        axis.text.x=element_text(angle = 35, hjust = 1))
```




